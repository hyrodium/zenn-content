---
title: "ãªã‚ã‚‰ã‹ãªæ›²ç·šã‚’Juliaã§SVGå‡ºåŠ›ã™ã‚‹"
emoji: "ğŸŒŠ"
type: "tech"
topics:
  - "julia"
  - "math"
  - "bã‚¹ãƒ—ãƒ©ã‚¤ãƒ³"
published: true
published_at: "2021-12-29 15:04"
---

# æ¦‚è¦
* Plots.jlã§å‡ºåŠ›ã•ã‚Œã‚‹ã‚°ãƒ©ãƒ•(æ›²ç·š)ã¯æŠ˜ã‚Œç·šãªã®ã§ã‚«ã‚¯ã‚«ã‚¯ã—ã¦ã„ã‚‹ã€‚
* `BasicBSpline`ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã£ã¦å‡ºåŠ›ã™ã‚Œã°BÃ©zieræ›²ç·šã§è¿‘ä¼¼ã•ã‚Œã‚‹ã®ã§å¬‰ã—ã„ï¼

æœ¬è¨˜äº‹ã§ä½¿ã†ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯Juliaã®REPLã‹ã‚‰ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã™ã€‚
```julia
]add Plots
add StaticArrays
add BasicBSpline
add https://github.com/hyrodium/BasicBSplineExporter.jl
```

# Plots.jlã§ã®å‡ºåŠ›
[Plots.jlãƒ‘ãƒƒã‚±ãƒ¼ã‚¸](https://docs.juliaplots.org/latest/)ã‚’ä½¿ã£ã¦ã‚°ãƒ©ãƒ•ã‚’å‡ºåŠ›ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚

```julia
using Plots

plot(sin,-8,8)  # æ­£å¼¦æ³¢ã‚’-8ã‹ã‚‰8ã¾ã§ãƒ—ãƒ­ãƒƒãƒˆ
savefig("sin_Plots.svg")  # SVGã§ä¿å­˜
savefig("sin_Plots.png")  # PNGã§ä¿å­˜
```
![](https://storage.googleapis.com/zenn-user-upload/88c9312f1fe5-20211228.png)

æ¥µå¤§å€¤ã®ä»˜è¿‘ã§SVGç”»åƒã‚’æ‹¡å¤§ã—ã¦ã¿ã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/b16f55765887-20211228.png)
![](https://storage.googleapis.com/zenn-user-upload/bc0cd79f198d-20211228.png)
ã‚«ã‚¯ã‚«ã‚¯ã—ã¦ã„ã¾ã™ã­ã€‚^[GRãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚’ä½¿ã£ã¦ä»Šå›ã¯æ¤œè¨¼ã—ã¦ã„ã¾ã™ã€‚ä»–ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã ã¨å¤‰ã‚ã‚‹ã‹ã‚‚çŸ¥ã‚Œã¾ã›ã‚“ã€‚]

ã“ã‚Œã¯æ›²ç·šãŒæŠ˜ã‚Œç·šã«ã‚ˆã£ã¦è¿‘ä¼¼ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã§ã™ã€‚ä»¥ä¸‹ã®ç”»åƒã¯SVGç”»åƒã‚’Inkscapeã§é–‹ã„ã¦ç¢ºèªã—ã¦ã„ã‚‹ã¨ã“ã‚ã§ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/79ad4275bcf3-20211228.png)

æ»‘ã‚‰ã‹ãªã‚°ãƒ©ãƒ•ã‚’å¾—ã‚‹ã«ã¯ã©ã®ã‚ˆã†ã«ã™ã‚Œã°è‰¯ã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ
SVGã§ã¯BÃ©zieræ›²ç·šã«å¯¾å¿œã—ã¦ã„ã‚‹ã®ã§ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã¨ã—ã¦ã¯å¯èƒ½ã®ã¯ãšâ€¦
**â†’ BasicBSplineãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ã„ã¾ã—ã‚‡ã†ï¼**

# BasicBSplineExporter.jlã§ã®å‡ºåŠ›

```julia
using BasicBSpline
using BasicBSplineExporter
using StaticArrays

f(t) = SVector(t,sin(t)) # æ­£å¼¦æ³¢ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è¡¨ç¤º
t0,t1 = -8,8             # å·¦ç«¯ã¨å³ç«¯

p = 3                                     # å¤šé …å¼æ¬¡æ•°ã€‚SVGã§ã¯3æ¬¡ã¾ã§ã®BÃ©zieræ›²ç·šãŒä½¿ãˆã‚‹ã€‚
k = KnotVector(t0:t1)+p*KnotVector(t0,t1) # ãƒãƒƒãƒˆåˆ—
P = BSplineSpace{p}(k)                    # B-splineç©ºé–“ã®å®šç¾©

a = fittingcontrolpoints(f,(P,))  # B-splineæ›²ç·šã®åˆ¶å¾¡ç‚¹ã®è¨ˆç®—
M = BSplineManifold(a,(P,)) # B-splineæ›²ç·šã®å®šç¾©
save_svg("sin_BasicBSpline.svg", M, xlims=(-10,10), ylims=(-2,2)) # B-splineæ›²ç·šã‚’SVGã§ä¿å­˜
save_png("sin_BasicBSpline.png", M, xlims=(-10,10), ylims=(-2,2)) # B-splineæ›²ç·šã‚’PNGã§ä¿å­˜![](https://storage.googleapis.com/zenn-user-upload/731678b5e5e8-20211229.png)
```
![](https://storage.googleapis.com/zenn-user-upload/bb495a477f42-20211229.png)

Inkscapeã§ç¢ºèªã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ã«BÃ©zieræ›²ç·šã§æ»‘ã‚‰ã‹ã«æ›²ç·šãŒè¡¨ç¾ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/7ab96d2ead78-20211229.png)
![](https://storage.googleapis.com/zenn-user-upload/f5158905ca58-20211229.png)

ä¸Šè¨˜ã®ã‚ˆã†ã«å®šç¾©ã—ãŸB-splineæ›²ç·šã¯å…¨ä½“ã§$C^2$ç´šã®æ»‘ã‚‰ã‹ã•ã‚’æŒã¤ã‚ˆã†ã«ãƒãƒƒãƒˆã®ä½ç½®ã§ç¹‹ãŒã‚Œã¦ã„ã¾ã™ã€‚å„åŒºé–“ã§ã¯å¤šé …å¼ã«ãªã£ã¦ã„ã‚‹ã®ã§ã€æ›²ç·šã¯åŒºåˆ†å¤šé …å¼ã¨ã—ã¦è¡¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

# æ»‘ã‚‰ã‹ã§ãªã„å ´åˆ(Plots.jl)
$f(x)=|\sin(x)|$ã®ã‚°ãƒ©ãƒ•ã‚’æã„ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
Plots.jlã§ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ã™ã‚Œã°ç”»åƒã®å‡ºåŠ›ã¾ã§ã§ãã¾ã™ã€‚
```julia
plot(absâˆ˜sin,-8,8)
savefig("abssin_Plots.svg")
savefig("abssin_Plots.png")
```
![](https://storage.googleapis.com/zenn-user-upload/8b88a5d81af0-20211229.png)
æŠ˜ã‚Œç·šè¿‘ä¼¼ãªã®ã§ã€å°é–¢æ•°ã®ä¸é€£ç¶šç‚¹ã§ã‚‚ç‰¹å¾´ã‚’æ‰ãˆãŸã‚°ãƒ©ãƒ•ã«ãªã£ã¦ã„ã‚‹ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚

ã—ã‹ã—å…ˆç«¯ã‚’æ‹¡å¤§ã—ã¦ã¿ã‚‹ã¨ã€ã‚°ãƒ©ãƒ•ã¯$y$è»¸ã«ã¯å½“ãŸã£ã¦ãŠã‚‰ãšã€ç‰¹ç•°ç‚¹ã®ä»˜è¿‘ã§æ­ªã‚“ã§è¦‹ãˆã¾ã™ã€‚
![](https://storage.googleapis.com/zenn-user-upload/49db087731fe-20211229.png)

# æ»‘ã‚‰ã‹ã§ãªã„å ´åˆ(BasicBSpline.jl)
ã“ã‚Œã¾ã§ã¨åŒæ§˜ã«ã€ä»¥ä¸‹ã‚’å®Ÿè¡Œã™ã‚Œã°ã‚°ãƒ©ãƒ•ãŒå‡ºåŠ›ã§ãã¾ã™ã€‚
```julia
f(t) = SVector(t,abs(sin(t)))
t0,t1 = -8,8
p = 3
k = KnotVector(range(t0,t1,length=50))+p*KnotVector(t0,t1)
P = BSplineSpace{p}(k)

a = fittingcontrolpoints(f,(P,))
M = BSplineManifold(a,(P,))
save_svg("abssin_BasicBSpline![](https://storage.googleapis.com/zenn-user-upload/555b66bd3bac-20211229.png).svg", M, xlims=(-10,10), ylims=(-2,2))
save_png("abssin_BasicBSpline.png", M, xlims=(-10,10), ylims=(-2,2))
```
å‡ºåŠ›ã•ã‚ŒãŸç”»åƒâ†“
![](https://storage.googleapis.com/zenn-user-upload/7de289a7db3a-20211229.png)

å°é–¢æ•°ã®ä¸é€£ç¶šç‚¹ã§ã®æ‹¡å¤§â†“
![](https://storage.googleapis.com/zenn-user-upload/0db7da0895db-20211229.png)

ãƒãƒƒãƒˆã®æ•°(åŒºåˆ†å¤šé …å¼ã®åˆ†å‰²ã®æ•°)ã‚’å¢—ã‚„ã—ãŸã¨ã—ã¦ã‚‚ã€Œæ»‘ã‚‰ã‹ã«ç¹‹ãã€ã¨ã„ã†åˆ¶ç´„ãŒã‚ã‚‹ã®ã§è¿‘ä¼¼ç²¾åº¦ã¯ã‚ã¾ã‚Šè‰¯ããªã‚Šã¾ã›ã‚“ã€‚

B-splineã§ã¯ã€ãƒãƒƒãƒˆã®é‡è¤‡ã«å¿œã˜ã¦é–¢æ•°ã®æ»‘ã‚‰ã‹ã•ãŒæ¸›ã‚‹ãŸã‚^[æ­£ç¢ºã«ã¯ã€$n$ç‚¹ã®ãƒãƒƒãƒˆã®é‡è¤‡ãŒã‚ã‚Œã°ãã®ç‚¹ã§$C^{p-n}$ç´šã®æ»‘ã‚‰ã‹ã•ã«ãªã‚Šã¾ã™ã€‚]ã€$\sin$ã®æ ¹ã®éƒ¨åˆ†ã«ãƒãƒƒãƒˆã‚’è¤‡æ•°é…ç½®ã™ã‚Œã°è‰¯ã„ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

```julia
k = KnotVector(range(t0,t1,length=12))+p*KnotVector(t0,t1)
k += p*KnotVector(-2Ï€:Ï€:2Ï€)  # æ»‘ã‚‰ã‹ã•ã‚’æ¸›ã‚‰ã—ãŸã„ç‚¹ã§ã®ãƒãƒƒãƒˆã‚’å¢—ã‚„ã™
P = BSplineSpace{p}(k)

a = fittingcontrolpoints(f,(P,))
M = BSplineManifold(a,(P,))
save_svg("abssin_BasicBSpline_modified.svg", M, xlims=(-10,10), ylims=(-2,2))
save_png("abssin_BasicBSpline_modified.png", M, xlims=(-10,10), ylims=(-2,2))
```
å‡ºåŠ›ã•ã‚ŒãŸç”»åƒâ†“
![](https://storage.googleapis.com/zenn-user-upload/6b5e6ce98a41-20211229.png)

æ‹¡å¤§ã—ã¦ã‚‚ç¶ºéº—ï¼â†“
![](https://storage.googleapis.com/zenn-user-upload/afc30a4f8f8c-20211229.png)

# ã¾ã¨ã‚
* BasicBSplineç­‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½¿ãˆã°æ»‘ã‚‰ã‹ãªã‚°ãƒ©ãƒ•ãŒå‡ºåŠ›ã§ãã¦ä¾¿åˆ©ï¼
* B-splineã§ã¯ãƒãƒƒãƒˆåˆ—ã®é‡è¤‡ã«å¿œã˜ã¦æ»‘ã‚‰ã‹ã•ã‚’å¤‰æ›´ã§ãã¦ä¾¿åˆ©ï¼
* ã¨ã‚Šã‚ãˆãšãƒ—ãƒ­ãƒƒãƒˆã™ã‚‹ã®ãªã‚‰Plots.jlãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒä¾¿åˆ©ï¼

# è¿½è¨˜
æœ¬è¨˜äº‹ã®è‹±èªç‰ˆã‚’[Julia Forem](https://forem.julialang.org/hyrodium/plotting-smooth-graphs-with-julia-6mj)ã«ã‚‚æŠ•ç¨¿ã—ã¾ã—ãŸã€‚
