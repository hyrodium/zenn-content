---
title: "Juliaパッケージの標準的なディレクトリ構成"
emoji: "👻"
type: "tech"
topics:
  - "julia"
  - "パッケージ管理"
published: false
---

# はじめに
Julia言語はパッケージ管理しやすい言語で

Juliaでは標準的な方法が浸透しているので、Pythonでの`requrements.txt`のようなレガシーを見る機会も少ないです。
また、Poetry/Pipenv/Ryeのようなパッケージマネージャーの乱立も無いので標準的なディレクトリ構成を議論しやすいです。

本記事では、最小限のパッケージ構成を示した後に、全部盛りのパッケージディレクトリ構成を紹介します。

# 最小限の構成
JuliaのREPLのパッケージモードで`generate`コマンドを実行すれば最小限の構成でパッケージが生成できます。
```
(@v1.9) pkg> generate MyPkgA
```

これらのファイル構成は以下のようになっています。

```
MyPkgA
├── Project.toml
└── src
    └── MyPkgA.jl
```

```toml: Project.toml
name = "MyPkgA"
uuid = "eb62ad0d-c07c-4140-a83b-b6ff560c525f"
authors = ["hyrodium <hyrodium@gmail.com>"]
version = "0.1.0"
```

```julia: src/MyPkgA.jl
module MyPkgA

greet() = print("Hello World!")

end # module MyPkgA
```

# 全部入りの構成

諸々全部入りで構成すると以下のようなディレクトリ構成になります。[^0]

[^0]: アルファベット順ではなく、説明順にsortしてます。

```
MyPkgB
├── .git
├── .gitignore
├── LICENSE.md
├── Project.toml
├── Manifest.toml
├── src
│   ├── MyPkgB.jl
│   └── <More julia scripts>.jl
├── ext
│   ├── MyPkgBOtherPkgCExt.jl
│   └── <More julia scripts>.jl
├── test
│   ├── Project.toml
│   ├── runtests.jl
│   └── <More julia test scripts>.jl
├── README.md
├── docs
│   ├── make.jl
│   ├── Project.toml
│   └── src
│       ├── assets
│       │   ├── custom.css
│       │   ├── favicon.ico
│       │   ├── logo-dark.svg
│       │   └── logo.svg
│       ├── img
│       │   └── <Some images for the documentation>
│       ├── index.md
│       └── <More markdown documentation>.md
└── .github
    ├── dependabot.yml
    └── workflows
        ├── CI.yml
        ├── Docs.yml
        ├── Invalidations.yml
        ├── CompatHelper.yml
        ├── TagBot.yml
        └── Format.yml
```

これらのファイルの意味やカスタマイズを解説するのが本記事の趣旨です。

## Git関連
### `.git`

JuliaのパッケージはGitが使われることが求められます。
`generate`コマンドで作った`MyPkgA`ではGit管理していませんでしたが、[General](https://github.com/JuliaRegistries/General)に登録されているパッケージではGit管理が求められます。[^1]

[^1]: バージョンごとにgitのcommitがGeneralに登録されているためです。例えばBasicBSpline.jlでは https://github.com/JuliaRegistries/General/blob/master/B/BasicBSpline/Versions.toml のように登録されています。

### `.gitignore`

最低限、以下は必要になります。

```
/Manifest.toml
/docs/build/
```

## ライセンス
### `LICENSE.md`

## ドキュメント (Documenter.jl)
### `docs/make.jl`

### `docs/Project.toml`

`compat`にDocumenter.jl

### `docs/Manifest.toml`

### `docs/src/assets/logo.svg`
ドキュメントのロゴ画像です。SVGだけでなく、PNGなども可能です。
k
![](https://raw.githubusercontent.com/hyrodium/BasicBSpline.jl/b0221e6662e6e16e706c8f784fb70a90da0fe6bd/docs/src/assets/logo.svg =200x)

### `docs/src/assets/logo-dark.svg`
ドキュメントのロゴ画像です。ダークモードで使われる画像を別途配置可能です。

![](https://raw.githubusercontent.com/hyrodium/BasicBSpline.jl/b0221e6662e6e16e706c8f784fb70a90da0fe6bd/docs/src/assets/logo-dark.svg =200x)

### `docs/src/assets/custom.css`
基本的に不要ですが、ドキュメントの見た目を変更したい場合に使用します。
私はドキュメントのロゴの大きさを変更するために以下のように記述することが多いです。([例](https://github.com/hyrodium/BasicBSpline.jl/blob/07ef789a01c826898782fae535a4638867c6742d/docs/src/assets/custom.css))

```css
#documenter .docs-sidebar .docs-logo > img,
html.theme--documenter-dark #documenter .docs-sidebar .docs-logo > img {
    max-height: 8rem;
}
```

### `docs/src/assets/favicon.ico`

ブラウザで表示した時に表示されるアイコンです。

![](https://storage.googleapis.com/zenn-user-upload/be317d43046a-20230910.png)

### `docs/src/index.md`

ドキュメントのトップページに関するmarkdownファイルです。

## ドキュメント (DemoCards.jl)
[DemoCards.jl](https://github.com/JuliaDocs/DemoCards.jl)はデモを作りやすくするためのJuliaパッケージで、Documenter.jlのドキュメントに組み込むことができます。

`docs/src`以下に置かないことに注意

### `docs/<dir>/assets`

### `docs/<dir>/index.md`

### `docs/<dir>/config.json`

## GitHub Actions

### `.github/workforlows/`

## README.md
READMEに色々なバッジが並んでいると格好いいですよね！付けましょう。

* docs/dev
* docs/stable
* CI
* codecov
* Aqua.jl
* arxiv
* DOI
* Package downloads
* style

## テスト

### `test/runtests.jl`
よくあるテストコードは以下のようなものです。

```julia

```

### `test/*.jl`


### doctest

Documenter.jlでdoctestが実行できますが、REPLの出力は

* `test/runtests.jl`に含めて`CI.yml`と同時に実行
  * :+1: doctestの内容がcoverageでカウントされる
  * :+1: テスト実行の際にdoctestまで確認できる
  * :-1: `CI.yml`で実行する際にバージョン制御が必要
* `test/runtests.jl`に含めず`DOCS.yml`と同時に実行
  * :+1: doctestの内容がcoverageでカウントされない
  * :-1: doctestが気軽でない
  * :+1: hogehoge

## その他

### `LICENSE`
MITにすることが多いです。
ファイル名を`LICENSE.md`に変更し、contributorsへのリンクを追加する場合もあります。([例](https://github.com/JuliaLang/julia/blob/master/LICENSE.md))

### `.JuliaFormatter.toml`
JuliaFormatter.jlで使う設定を記述するファイルです。

# パッケージ作成支援パッケージ

* [PkgTemplates.jl](https://github.com/JuliaCI/PkgTemplates.jl)
* [PkgSkeleton.jl](https://github.com/tpapp/PkgSkeleton.jl)
* GitHubの機能で..package templateがあったような

があります。

# おわりに

本記事で列挙したもの以外にも色々なパッケージ構成があると思います。
たとえば、以下の項目には意図的に触れませんでした。

* 一つのリポジトリで複数のパッケージを管理する方法
* Documenter.jl以外でのドキュメント生成

「このファイルも便利だから用意した方が良いよ！」などあればコメントください！
